////////////////////////////////////////////////////////////////////////////////////////////////////
// NoesisGUI - http://www.noesisengine.com
// Copyright (c) 2013 Noesis Technologies S.L. All Rights Reserved.
////////////////////////////////////////////////////////////////////////////////////////////////////


#include <NsApp/SetFocusAction.h>
#include <NsGui/UIElementData.h>
#include <NsCore/ReflectionImplement.h>


using namespace NoesisApp;


////////////////////////////////////////////////////////////////////////////////////////////////////
bool SetFocusAction::GetEngage() const
{
    return GetValue<bool>(EngageProperty);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
void SetFocusAction::SetEngage(bool value)
{
    SetValue<bool>(EngageProperty, value);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
Noesis::Ptr<Noesis::Freezable> SetFocusAction::CreateInstanceCore() const
{
    return *new SetFocusAction();
}

////////////////////////////////////////////////////////////////////////////////////////////////////
void SetFocusAction::Invoke(Noesis::BaseComponent*)
{
    Noesis::UIElement* element = GetTarget();
    if (element != 0)
    {
        element->Focus(GetEngage());
    }
}

////////////////////////////////////////////////////////////////////////////////////////////////////
NS_BEGIN_COLD_REGION

NS_IMPLEMENT_REFLECTION(SetFocusAction, "NoesisGUIExtensions.SetFocusAction")
{
    Noesis::UIElementData* data = NsMeta<Noesis::UIElementData>(Noesis::TypeOf<SetFocusAction>());
    data->RegisterProperty<bool>(EngageProperty, "Engage",
        Noesis::PropertyMetadata::Create(true));
}

NS_END_COLD_REGION

////////////////////////////////////////////////////////////////////////////////////////////////////
const Noesis::DependencyProperty* SetFocusAction::EngageProperty;
