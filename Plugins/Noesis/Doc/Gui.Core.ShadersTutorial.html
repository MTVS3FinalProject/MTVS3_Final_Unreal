<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<title>Extending with Shaders - Documentation | NoesisGUI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Tutorial about extending NoesisGUI with custom shaders to create new effects and brushes" name="description" />
<meta content="ShadersTutorialImg1.jpg" name="image" />

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@noesisengine" />
<meta name="twitter:url" content="https://www.noesisengine.com/docs/Gui.Core.ShadersTutorial.html" />
<meta name="twitter:title" content="Extending with Shaders | NoesisGUI" />
<meta name="twitter:description" content="Tutorial about extending NoesisGUI with custom shaders to create new effects and brushes" />
<meta name="twitter:image" content="https://www.noesisengine.com/docs/ShadersTutorialImg1.jpg" />

<!-- Facebook Cards -->
<meta property="og:title" content="Extending with Shaders | NoesisGUI" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://www.noesisengine.com/docs/ShadersTutorialImg1.jpg" />
<meta property="article:published_time" content="2024-10-26 14:42:42" />
<meta property="og:description" content="Tutorial about extending NoesisGUI with custom shaders to create new effects and brushes" />
<meta property="og:url" content="https://www.noesisengine.com/docs/Gui.Core.ShadersTutorial.html" />
<meta property="og:site_name" content="NoesisGUI" />

<link rel="canonical" href="https://www.noesisengine.com/docs/Gui.Core.ShadersTutorial.html" />
<link rel="shortcut icon" href="/favicon.ico" />

<!--script src="https://use.typekit.net/taq4txx.js"></script-->
<!--script>try{Typekit.load({ async: true });}catch(e){}</script-->

<link rel="stylesheet" href="style/noesis.css?version=16" type="text/css" media="all"/>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KE76SPT9HR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KE76SPT9HR');
</script>

<script src="/js/vendor/modernizr.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


</head>
<body>
<div class="document" id="extending-with-shaders">


    <!-- NOESIS WEB ------- BEGIN ------- -->

    <div class="developers documentation">

        <!--[if lt IE 9]>
        <script type="text/javascript" src="/js/vendor/selectivizr.js"></script>
        <script type="text/javascript" src="/js/vendor/respond.js"></script>
        <div class="old-browser-warning">
            You are using a very old browser.<br>
            To get the best possible experience using our website we recommend that you upgrade to a newer version or other web browser. <br>
            A list of the most popular web browsers <a href="http://browsehappy.com/">can be found here</a>
        </div>
        <![endif]-->

        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
            <symbol id="svg-icon-social-github" width="30" height="30" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></symbol>
            <symbol id="svg-icon-social-linkedin" width="30" height="30" viewBox="-26 25 30 30"><path d="M-22.6 51.3h5v-15h-5v15zm17.8-15.5c-2.2 0-3.5.8-4.8 2.6v-2.1h-5v15h5v-8.1c0-1.7.9-3.4 2.8-3.4 2 0 3.2 1.7 3.2 3.4v8.2h5v-8.5c0-6-4-7.1-6.2-7.1zM-20.1 29c-1.6 0-2.9 1.2-2.9 2.6 0 1.5 1.3 2.6 2.9 2.6 1.6 0 2.9-1.2 2.9-2.6.1-1.4-1.2-2.6-2.9-2.6z"></symbol>
            <symbol id="svg-icon-social-twitter" width="30" height="30" viewBox="0 0 300 300.251"><g transform="scale(.8)" transform-origin="150 250"><path d="M178.57 127.15 290.27 0h-26.46l-97.03 110.38L89.34 0H0l117.13 166.93L0 300.25h26.46l102.4-116.59 81.8 116.59h89.34M36.01 19.54H76.66l187.13 262.13h-40.66"/></g></symbol>
            <symbol id="svg-icon-social-youtube" width="32" height="30" viewBox="10 30 400 300"><g transform="scale(1.3)" transform-origin="200 150"><path d="M199.91667116 105.6302382s-84.29180001.00007866-105.44791902 5.49739608c-11.32771618 3.16506938-20.655211 12.49266687-23.82031238 23.98698305-5.49727075 21.15613367-5.49739608 64.9687477-5.49739608 64.9687477s.00012533 43.97893404 5.49739608 64.80208104c3.16510139 11.49416018 12.3260082 20.65517366 23.82031238 23.82032038 21.32270701 5.6638401 105.44791902 5.66405342 105.44791902 5.66405342s84.45890802-.00006666 105.61458836-5.49738675c11.49438685-3.16508005 20.655107-12.15954686 23.65364037-23.82032038 5.66390676-20.98976034 5.66406676-64.80208104 5.66406676-64.80208104s.16645334-43.9792807-5.66406676-65.13541437c-2.99853338-11.49431618-12.15925352-20.65511233-23.65364037-23.65364971-21.15568034-5.83046276-105.61458836-5.83072943-105.61458836-5.83072943zm-26.8203071 53.97395285 70.13281446 40.47917398-70.13281445 40.31250732v-80.7916813z"/></g></symbol>
            <symbol id="svg-scroll-down" viewBox="0 0 48 48"><path d="M24 1C11.3 1 1 11.3 1 24s10.3 23 23 23 23-10.3 23-23S36.7 1 24 1zm0 31.5L11.9 21.6l1.3-1.5L24 29.8l10.7-9.7 1.3 1.5-12 10.9z"></symbol>
        </svg>

        <header id="header" class="SOZO-header js-hide-nav">

            <div class="wrapper">

                <a href="/" class="logo animate-me goto" title="NoesisGUI">
                    <img src="/images/logos/noesis-logo-blue.svg" alt="NoesisGUI">
                </a>

                <div class="user-management">
                    <iframe src="/includes/user.php" scrolling="no"></iframe>
                </div>

                <a title="Menu" href="/" class="mobile-menu" rel="nofollow">
                    <i class="burger-icon"></i>
                </a>

                <nav class="primary-nav site-nav" role="navigation">
                    <ul>
                        <li><a href="/" title="NoesisGUI"><span>home</span></a></li>
                        <li><a href="/noesisgui" title="NoesisGUI Features"><span>features</span></a></li>
                        <li><a href="/studio" title="NoesisGUI Studio"><span>studio</span></a></li>
                        <li><a href="/licensing.php" title="NoesisGUI Pricing"><span>pricing</span></a></li>
                        <li class="has-children">
                            <a data-id="child-nav" href="/forums" title="NoesisGUI Developer Resources" class="js-mobile-2nd-nav active"><span>developer</span></a>
                            <nav class="child-nav" id="child-nav">
                                <ul>
                                    <li><a href="/forums" title="NoesisGUI Forums">forums</a></li>
                                    <li><a href="/developers/samples.php" title="NoesisGUI Samples">samples</a></li>
                                    <li><a href="/xamltoy" title="NoesisGUI XamlToy">xamltoy</a></li>
                                    <li><a href="/developers/downloads.php" title="NoesisGUI Downloads">downloads</a></li>
                                    <li><a href="/docs/Gui.Core.Index.html" title="NoesisGUI Documentation" class="active">documentation</a></li>
                                    <li><a href="/bugs/my_view_page.php" target="_blank" rel="nofollow" title="NoesisGUI Bug Tracker">bugtracker</a></li>
                                    <li><a href="/bugs/roadmap_page.php" target="_blank" rel="nofollow" title="NoesisGUI Roadmap">roadmap</a></li>
                                </ul>
                            </nav>
                        </li>
                        <li><a href="/contact.php" title="Noesis Contact"><span>Contact</span></a></li>
                    </ul>
                </nav>

            </div>

        </header>

        <header id="doc-header">
            <img src="noesis-gui-logo.svg" alt="NoesisGUI">
        </header>

        <div class="main-content" role="main">

            <nav id="noesis-secondary-nav" class="secondary-nav site-nav js-hide-nav">
                <div class="wrapper">
                    <ul>
                        <li><a href="/forums" title="NoesisGUI Forums">forums</a></li>
                        <li><a href="/developers/samples.php" title="NoesisGUI Samples">samples</a></li>
                        <li><a href="/xamltoy" title="NoesisGUI XamlToy">xamltoy</a></li>
                        <li><a href="/developers/downloads.php" title="NoesisGUI Downloads">downloads</a></li>
                        <li><a href="/docs/Gui.Core.Index.html" title="NoesisGUI Documentation" class="active">documentation</a></li>
                        <li><a href="/bugs/my_view_page.php" target="_blank" rel="nofollow" title="NoesisGUI Bug Tracker">bugtracker</a></li>
                        <li><a href="/bugs/roadmap_page.php" target="_blank" rel="nofollow" title="roadmap">roadmap</a></li>
                    </ul>
                </div>
            </nav>


            <div class="documentation-article">

                <div class="wrapper">

                    <div id="noesis_web_contenidosMain" class="noesis_web_contenidosMain sozo-content">
                        <div id="noesis_doc_wrap">

                            <div class="noesis_doc_header_menu">
                                <div class="noesis_doc_search_container">
                                    <div class="noesis_doc_search_box">
                                      <input id="docsearch-input" class="noesis_doc_search_input"
                                        aria-autocomplete="both" aria-labelledby="docsearch-label"
                                        autocomplete="off" autocorrect="off" autocapitalize="off" enterkeyhint="search" spellcheck="false"
                                        placeholder="Search docs..."
                                        maxlength="64" type="search" value="">
                                    </div>
                                </div>
                                <a href="Gui.Core.Index.html" class="noesis_doc_header_link">
                                    <img src="blue-home-icon.png?version=3.2" alt="Documentation Index" title="Documentation Index">
                                </a>
                            </div>

                            <div class="noesis_doc_content">

        <!-- NOESIS WEB ------- END ------- -->


<h1 class="title">Extending with Shaders</h1>

<p>There are two ways where custom shaders can be used in NoesisGUI. <em>Effects</em> apply a post-processing shader to any object including children. On the other hand, <em>Brushes</em> can be customized with a shader to define how elements are filled and stroked. The following sections describe both approaches in more detail.</p>
<p>In both cases, a pixel shader compatible with the active <em>RenderDevice</em> is required. Our <em>Application Framework</em> provides a <a class="reference external" href="Gui.Core.ApplicationTutorial.html#shader-compiler">ShaderCompiler</a> tool that is used in C++ and Unity. For Unreal, the native <a class="reference external" href="Gui.Core.UnrealTutorial.html#materials">Shader Graph</a> editor must be used.</p>
<div class="section" id="shader-effects">
<h1>Shader Effects</h1>
<p>NoesisGUI has two special visual effects built in that can be applied to any <a class="reference external" href="Gui.Core._Visual.html">Visual</a>. These effects are <a class="reference external" href="Gui.Core._DropShadowEffect.html">DropShadowEffect</a> and <a class="reference external" href="Gui.Core._BlurEffect.html">BlurEffect</a>, which both derive from the abstract <a class="reference external" href="Gui.Core._Effect.html">Effect</a> class.</p>
<p>To apply an effect to a relevant object, you simply sets its <em>Effect</em> property to an instance of one of the Effect-derived classes. For example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;Grid</span>
  <span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
  <span class="na">xmlns:x=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Image</span> <span class="na">Width=</span><span class="s">&quot;300&quot;</span> <span class="na">Height=</span><span class="s">&quot;300&quot;</span> <span class="na">Source=</span><span class="s">&quot;Images/image.jpg&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Image.Effect&gt;</span>
        <span class="nt">&lt;BlurEffect</span> <span class="na">Radius=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/Image.Effect&gt;</span>
    <span class="nt">&lt;/Image&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</pre></div>
<p>The exciting part is not necessarily the two built-in ones but a third <a class="reference external" href="Gui.Core._Effect.html">Effect</a> subclass called <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a> that enables you to easily inject your own custom effects. By deriving from the abstract <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a> class, you can apply any pixel shader to any <a class="reference external" href="Gui.Core._UIElement.html">UIElement</a> of the tree.</p>
<p>There are many steps necessary to create a working shader effect class. To ease the development of custom shaders, the <a class="reference external" href="Gui.Core.ApplicationTutorial.html">Application Framework</a> provides the following effects, we recommend inspecting the source code of these effects while reading this tutorial:</p>
<ul class="simple">
<li><a class="reference external" href="App.Shaders._DirectionalBlurEffect.html">DirectionalBlurEffect</a></li>
<li><a class="reference external" href="App.Shaders._PinchEffect.html">PinchEffect</a></li>
<li><a class="reference external" href="App.Shaders._PixelateEffect.html">PixelateEffect</a></li>
<li><a class="reference external" href="App.Shaders._SaturationEffect.html">SaturationEffect</a></li>
<li><a class="reference external" href="App.Shaders._TintEffect.html">TintEffect</a></li>
<li><a class="reference external" href="App.Shaders._VignetteEffect.html">VignetteEffect</a></li>
</ul>
<img alt="ShadersTutorialImg1.jpg" src="ShadersTutorialImg1.jpg" />
<div class="section" id="creating-custom-effects">
<h2>Creating Custom Effects</h2>
<p><a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a> is the abstract class that serves as a base for your custom effect class. It is a dependency object, so you can populate it with dependency properties to define the parameters of your effect. As described above, it works in conjunction with a pixel shader.</p>
<p>For example, the <a class="reference external" href="App.Shaders._PixelateEffect.html">PixelateEffect</a> uses the following shader:</p>
<div class="highlight"><span class="filename">Pixelate.noesiseffect</span><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;EffectHelpers.h&quot;</span><span class="cp"></span>

<span class="n">uniforms</span>
<span class="p">{</span>
    <span class="kt">float</span> <span class="n">_size</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">fixed4</span> <span class="nf">main_effect</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">float2</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">GetImagePosition</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">_size</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">_size</span> <span class="o">/</span> <span class="mf">2.0f</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">float2</span> <span class="n">brickNum</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">pos</span> <span class="o">/</span> <span class="n">_size</span><span class="p">);</span>
    <span class="n">float2</span> <span class="n">centerOfBrick</span> <span class="o">=</span> <span class="n">brickNum</span> <span class="o">*</span> <span class="n">_size</span> <span class="o">+</span> <span class="n">_size</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">SampleInputAtPosition</span><span class="p">(</span><span class="n">centerOfBrick</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>The following inputs are exposed to the pixel shader in form of functions by using the <em>EffectHelpers.h</em> include:</p>
<ul class="simple">
<li><strong>GetInputCoordinate()</strong>, returns the current input coordinate. As the effect may be generated inside an texture atlas, shaders shouldn't take any dependencies on how this value is calculated. It should use it only to the pixel shader's input. For rest of cases <em>GetNormalizedInputCoordinate</em> is recommended.</li>
<li><strong>GetNormalizedInputCoordinate()</strong>, returns the current normalized input coordinates in the range 0 to 1.</li>
<li><strong>GetImagePosition()</strong>, returns the current image position in pixels.</li>
<li><strong>GetOpacity()</strong>, returns the current opacity.</li>
<li><strong>GetInput()</strong>, returns the color at the current input coordinates.</li>
<li><strong>SampleInput()</strong>, samples input at position uv.</li>
<li><strong>SampleInputAtOffset()</strong>, samples input at an offset in pixels from the input coordinate.</li>
<li><strong>SampleInputAtPosition()</strong>, samples input at an absolute scene position in pixels.</li>
</ul>
<p>Once the pixel shader is loaded it must be stored in the <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a> instance calling <em>SetPixelShader</em>. Note that only one shader must be loaded for all instances of the same effect. Parametrized effects use a constant buffer to send parameters to the pixel shader. The constant buffer is set in the constructor of the effect by calling <em>SetConstantBuffer</em> and every time a parameter changes the constant buffer must be updated with the function <em>InvalidateConstantBuffer</em>.</p>
<div class="highlight"><span class="filename">C++</span><pre><span></span><span class="n">PixelateEffect</span><span class="o">::</span><span class="n">PixelateEffect</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">RenderContext</span><span class="o">::</span><span class="n">EnsureShaders</span><span class="p">(</span><span class="n">Shaders</span><span class="p">,</span> <span class="s">&quot;Pixelate&quot;</span><span class="p">,</span> <span class="n">Pixelate_bin</span><span class="p">);</span>

    <span class="n">SetPixelShader</span><span class="p">(</span><span class="n">Shaders</span><span class="p">.</span><span class="n">shaders</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">SetConstantBuffer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mConstants</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">mConstants</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><span class="filename">C++</span><pre><span></span><span class="n">NS_IMPLEMENT_REFLECTION</span><span class="p">(</span><span class="n">PixelateEffect</span><span class="p">,</span> <span class="s">&quot;NoesisGUIExtensions.PixelateEffect&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">OnBrickSizeChanged</span> <span class="o">=</span> <span class="p">[](</span><span class="n">DependencyObject</span><span class="o">*</span> <span class="n">o</span><span class="p">,</span> <span class="k">const</span> <span class="n">DependencyPropertyChangedEventArgs</span><span class="o">&amp;</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">PixelateEffect</span><span class="o">*</span> <span class="n">this_</span> <span class="o">=</span> <span class="p">(</span><span class="n">PixelateEffect</span><span class="o">*</span><span class="p">)</span><span class="n">o</span><span class="p">;</span>
        <span class="n">this_</span><span class="o">-&gt;</span><span class="n">mConstants</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">NewValue</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="n">this_</span><span class="o">-&gt;</span><span class="n">InvalidateConstantBuffer</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="n">UIElementData</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="n">NsMeta</span><span class="o">&lt;</span><span class="n">UIElementData</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TypeOf</span><span class="o">&lt;</span><span class="n">SelfClass</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="n">data</span><span class="o">-&gt;</span><span class="n">RegisterProperty</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">SizeProperty</span><span class="p">,</span> <span class="s">&quot;Size&quot;</span><span class="p">,</span> <span class="n">UIPropertyMetadata</span><span class="o">::</span><span class="n">Create</span><span class="p">(</span>
        <span class="mf">5.0f</span><span class="p">,</span> <span class="n">PropertyChangedCallback</span><span class="p">(</span><span class="n">OnBrickSizeChanged</span><span class="p">)));</span>
<span class="p">}</span>
</pre></div>
<p>An effect is normally applied to an element's actual render size. Therefore an effect for a 200×200 Image will modify pixels in a 200×200 region. Certain effects, like the drop shadow, need additional space outside the normal render area. Use the <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a> <em>SetPadding</em> function to increase the size required in the pixel shader.</p>
</div>
</div>
<div class="section" id="shader-brushes">
<h1>Shader Brushes</h1>
<p>Apart from <em>Effects</em>, NoesisGUI provides functionality that allows <a class="reference external" href="Gui.Core._ImageBrush.html">ImageBrush</a> to be extended by using pixel shaders. By deriving from the abstract <a class="reference external" href="Gui.Core._BrushShader.html">BrushShader</a> class, you can generate procedural pattern brushes driven by a pixel shader.</p>
<p>In comparison with <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a>, a brush shader is more efficient because it doesn't need an extra render pass to an offscreen. But on the other hand, it cannot be applied to a tree of elements.</p>
<p>To apply a shader brush to an <a class="reference external" href="Gui.Core._ImageBrush.html">ImageBrush</a>, you set its <em>Brush.Shader</em> property. Note that this is an <a class="reference external" href="Gui.Core.ExtensionsTutorial.html">Extension</a> to WPF provided by NoesisGUI.</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;Grid</span>
  <span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
  <span class="na">xmlns:noesis=</span><span class="s">&quot;clr-namespace:NoesisGUIExtensions;assembly=Noesis.GUI.Extensions&quot;</span>
  <span class="na">xmlns:local=</span><span class="s">&quot;clr-namespace:CustomBrushes&quot;</span><span class="nt">&gt;</span>

  <span class="nt">&lt;Rectangle</span> <span class="na">Width=</span><span class="s">&quot;300&quot;</span> <span class="na">Height=</span><span class="s">&quot;300&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Rectangle.Fill&gt;</span>
      <span class="nt">&lt;ImageBrush</span> <span class="na">ImageSource=</span><span class="s">&quot;Images/image.jpg&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;noesis:Brush.Shader&gt;</span>
          <span class="nt">&lt;local:WaveBrush</span> <span class="na">Frequency=</span><span class="s">&quot;0.7&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/noesis:Brush.Shader&gt;</span>
      <span class="nt">&lt;/ImageBrush&gt;</span>
    <span class="nt">&lt;/Rectangle.Fill&gt;</span>
  <span class="nt">&lt;/Rectangle&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</pre></div>
<p>The <a class="reference external" href="Gui.Core.ApplicationTutorial.html">Application Framework</a> provides the following shader brushes as examples:</p>
<ul class="simple">
<li><a class="reference external" href="App.Shaders._ConicGradientBrush.html">ConicGradientBrush</a></li>
<li><a class="reference external" href="App.Shaders._MonochromeBrush.html">MonochromeBrush</a></li>
<li><a class="reference external" href="App.Shaders._PlasmaBrush.html">PlasmaBrush</a></li>
<li><a class="reference external" href="App.Shaders._WavesBrush.html">WavesBrush</a></li>
<li><a class="reference external" href="App.Shaders._CrossFadeBrush.html">CrossFadeBrush</a></li>
</ul>
<img alt="ShadersTutorialImg2.jpg" src="ShadersTutorialImg2.jpg" />
<div class="section" id="creating-shader-brushes">
<h2>Creating Shader Brushes</h2>
<p><a class="reference external" href="Gui.Core._BrushShader.html">BrushShader</a> is the abstract class that serves as a base for your custom brush. It is a dependency object, so you can populate it with dependency properties to configure your shader. Same as in <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a>, this class works in conjunction with a pixel shader.</p>
<p>For example, the <a class="reference external" href="App.Shaders._MonochromeBrush.html">MonochromeBrush</a> uses the following shader:</p>
<div class="highlight"><span class="filename">Monochrome.noesisbrush</span><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;BrushHelpers.h&quot;</span><span class="cp"></span>

<span class="n">uniforms</span>
<span class="p">{</span>
    <span class="n">fixed4</span> <span class="n">_color</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">fixed4</span> <span class="nf">main_brush</span><span class="p">(</span><span class="n">float2</span> <span class="n">uv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">fixed4</span> <span class="n">c</span> <span class="o">=</span> <span class="n">SampleImage</span><span class="p">(</span><span class="n">uv</span><span class="p">);</span>
    <span class="n">fixed</span> <span class="n">l</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">r</span> <span class="o">*</span> <span class="mf">0.30</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">g</span> <span class="o">*</span> <span class="mf">0.59</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">b</span> <span class="o">*</span> <span class="mf">0.11</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">float4</span><span class="p">(</span><span class="n">_color</span><span class="p">.</span><span class="n">r</span> <span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="n">_color</span><span class="p">.</span><span class="n">g</span> <span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="n">_color</span><span class="p">.</span><span class="n">b</span> <span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">a</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>In contrast with <a class="reference external" href="Gui.Core._ShaderEffect.html">ShaderEffect</a>, now we are using 'BrushHelpers.h' to get a different set of helper functions. For example, <em>SampleImage()</em> is used to sample the texture corresponding to the <a class="reference external" href="Gui.Core._ImageBrush.html">ImageBrush</a>.</p>
<p>Once the pixel shader is loaded it must be stored in the <a class="reference external" href="Gui.Core._BrushShader.html">BrushShader</a> instance calling <em>SetPixelShader</em> for each target. For example, different shader variants are needed if the brush is applied to a text or a path. Note that only one shader must be loaded for all instances of the same effect. Parametrized effects use a constant buffer to send parameters to the pixel shader. The constant buffer is set in the constructor of the shader brush by calling <em>SetConstantBuffer</em> and every time a parameter changes the constant buffer must be updated with the function <em>InvalidateConstantBuffer</em>.</p>
<div class="highlight"><span class="filename">C++</span><pre><span></span><span class="n">MonochromeBrush</span><span class="o">::</span><span class="n">MonochromeBrush</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">RenderContext</span><span class="o">::</span><span class="n">EnsureShaders</span><span class="p">(</span><span class="n">Shaders</span><span class="p">,</span> <span class="s">&quot;Monochrome&quot;</span><span class="p">,</span> <span class="n">Monochrome_bin</span><span class="p">);</span>

    <span class="n">SetConstantBuffer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mConstants</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">mConstants</span><span class="p">));</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NS_COUNTOF</span><span class="p">(</span><span class="n">Shaders</span><span class="p">.</span><span class="n">shaders</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">SetPixelShader</span><span class="p">(</span><span class="n">Shaders</span><span class="p">.</span><span class="n">shaders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">BrushShader</span><span class="o">::</span><span class="n">Target</span><span class="p">)</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><span class="filename">C++</span><pre><span></span><span class="n">NS_IMPLEMENT_REFLECTION</span><span class="p">(</span><span class="n">MonochromeBrush</span><span class="p">,</span> <span class="s">&quot;NoesisGUIExtensions.MonochromeBrush&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">OnColorChanged</span> <span class="o">=</span> <span class="p">[](</span><span class="n">DependencyObject</span><span class="o">*</span> <span class="n">o</span><span class="p">,</span> <span class="k">const</span> <span class="n">DependencyPropertyChangedEventArgs</span><span class="o">&amp;</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MonochromeBrush</span><span class="o">*</span> <span class="n">this_</span> <span class="o">=</span> <span class="p">(</span><span class="n">MonochromeBrush</span><span class="o">*</span><span class="p">)</span><span class="n">o</span><span class="p">;</span>
        <span class="n">this_</span><span class="o">-&gt;</span><span class="n">mConstants</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">NewValue</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="n">this_</span><span class="o">-&gt;</span><span class="n">InvalidateConstantBuffer</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="n">UIElementData</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="n">NsMeta</span><span class="o">&lt;</span><span class="n">UIElementData</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TypeOf</span><span class="o">&lt;</span><span class="n">SelfClass</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="n">data</span><span class="o">-&gt;</span><span class="n">RegisterProperty</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ColorProperty</span><span class="p">,</span> <span class="s">&quot;Color&quot;</span><span class="p">,</span>
        <span class="n">UIPropertyMetadata</span><span class="o">::</span><span class="n">Create</span><span class="p">(</span><span class="n">Color</span><span class="o">::</span><span class="n">White</span><span class="p">(),</span> <span class="n">PropertyChangedCallback</span><span class="p">(</span><span class="n">OnColorChanged</span><span class="p">)));</span>
<span class="p">}</span>
</pre></div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#shader-effects" id="id16">Shader Effects</a><ul>
<li><a class="reference internal" href="#creating-custom-effects" id="id17">Creating Custom Effects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shader-brushes" id="id18">Shader Brushes</a><ul>
<li><a class="reference internal" href="#creating-shader-brushes" id="id19">Creating Shader Brushes</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


        <!-- NOESIS WEB ------- BEGIN ------- -->

                            </div> <!-- eo noesis_doc_content -->
                        </div> <!-- eo doc_wrap -->
                    </div> <!-- eo noesis_web_contenidosMain -->

                </div> <!-- eo wrapper -->

            </div>  <!-- eo documentation-article -->

        </div> <!-- eo main-content -->

        <footer id="footer" class="SOZO-footer">
            <div class="wrapper">
                <ul class="footer saciol-icon-list">
                    <li>
                        <a href="https://github.com/Noesis" title="NoesisGUI GitHub" target="_blank">
                            <i class="svg-icon"><svg class="icon-saciol-github"><use xlink:href="#svg-icon-social-github"></use></svg></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/company/noesis-technologies-sl" title="NoesisGUI Linkedin" target="_blank">
                            <i class="svg-icon"><svg class="icon-saciol-linkedin"><use xlink:href="#svg-icon-social-linkedin"></use></svg></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/noesisengine" title="NoesisGUI Twitter" target="_blank">
                            <i class="svg-icon"><svg class="icon-saciol-twitter"><use xlink:href="#svg-icon-social-twitter"></use></svg></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.youtube.com/user/NoesisTechnologies" title="NoesisGUI Youtube" target="_blank">
                            <i class="svg-icon"><svg class="icon-saciol-youtube"><use xlink:href="#svg-icon-social-youtube"></use></svg></i>
                        </a>
                    </li>
                </ul>

                <div class="footer-extended">

                    <div class="cols">

                        <nav class="unit">
                            <h3 class="title">home</h3>
                            <ul>
                                <li><a href="/#goto-home-projects" class="goto" title="Made with NoesisGUI">Projects</a></li>
                                <li><a href="/#goto-home-testimonials" class="goto" title="Customer testimonials">Testimonials</a></li>
                                <li><a href="/customers.php" class="goto" title="NoesisGUI happy customers">Customers</a></li>
                                <li><a href="/partners" class="goto" title="Noesis Verified Partners">Partners</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">features</h3>
                            <ul>
                                <li><a href="/noesisgui/#goto-noesisgui-overview" class="goto" title="NoesisGUI technology overview">Overview</a></li>
                                <li><a href="/noesisgui/#goto-noesisgui-compatibility" class="goto" title="NoesisGUI compatibility">Compatibility</a></li>
                                <li><a href="/noesisgui/#goto-noesisgui-highlights" class="goto" title="NoesisGUI best features">Highlights</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">studio</h3>
                            <ul>
                                <li><a href="/studio/#goto-studio-overview" class="goto" title="Noesis Studio overview">Overview</a></li>
                                <li><a href="/studio/#goto-studio-learning" class="goto" title="Noesis Studio learn resources">Learning</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">Pricing</h3>
                            <ul>
                                <li><a href="/licensing.php#goto-licensing-prices" class="goto" title="NoesisGUI Prices">Prices</a></li>
                                <li><a href="/licensing.php#goto-licensing-faqs" class="goto" title="NoesisGUI Licensing Notes">FAQs</a></li>
                                <li><a href="/presskit.php" class="goto" title="NoesisGUI Logos">Logos</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">Developers</h3>
                            <ul>
                                <li><a href="/developers/downloads.php" class="goto" title="NoesisGUI Downloads">Downloads</a></li>
                                <li><a href="/docs/Gui.Core.Index.html" class="goto" title="NoesisGUI Documentation">Documentation</a></li>
                                <li><a href="/forums" class="goto" title="NoesisGUI Forums">Forums</a></li>
                                <li><a href="/bugs/my_view_page.php" class="goto" target="_blank" rel="nofollow" title="NoesisGUI Bug Tracker">Bugtracker</a></li>
                                <li><a href="/xamltoy" class="goto" title="NoesisGUI XamlToy">XamlToy</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">Contact</h3>
                            <ul>
                                <li><a href="/contact.php#goto-contact-about" class="goto" title="About NoesisGUI">About</a></li>
                                <li><a href="/contact.php#goto-contact-details" class="goto" title="Contact NoesisGUI">Contact Us</a></li>
                                <li><a href="/jobs.php" class="goto" title="Careers NoesisGUI">Careers</a></li>
                            </ul>
                        </nav>

                    </div>

                    <nav class="legal">
                        <figure class="SOZO-media logo">
                            <img src="/images/logos/noesis-logo-whitefg.svg">
                        </figure>
                        <p>&copy; 2013 Noesis Technologies</p>
                        <a href="/legal/privacy.php" title="Privacy Policy" rel="nofollow">Privacy</a>
                        <a href="/legal/cookies.php" title="Cookie Policy" rel="nofollow">Cookies</a>
                        <a href="/legal/terms-of-use.php" title="Terms and Conditions" rel="nofollow">Terms &amp; Conditions</a>
                    </nav>

                </div>

                <div class="footer-reduced">
                    <ul>
                        <li><a href="/noesisgui/" class="goto" title="NoesisGUI Technology">NoesisGUI</a></li>
                        <li><a href="/studio/" class="goto" title="Noesis Studio">Studio</a></li>
                        <li><a href="/licensing.php" class="goto" title="Pricing">Pricing</a></li>
                        <li><a href="/forums" class="goto" title="Forums">Developer</a></li>
                        <li><a href="/contact.php" class="goto" title="Contact us">Contact</a></li>
                    </ul>
                    <ul class="copyright-legal">
                        <li>&copy; 2013 Noesis Technologies</li>
                        <li><a href="/legal/privacy.php" title="Privacy Policy" rel="nofollow">Privacy</a></li>
                        <li><a href="/legal/terms-of-use.php" title="Terms and Conditions" rel="nofollow">Terms &amp; Conditions</a></li>
                    </ul>
                </div>
            </div>
        </footer>

        <footer id="doc-footer">
            <span>&copy; 2017 Noesis Technologies</span>
        </footer>

    </div> <!-- eo developers documentation -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!-- Use if you want latest version of 1x -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->

    <!-- If using 1.11.3 make sure you update the fallback file below to 1.11.3 -->
    <script>window.jQuery || document.write('<script src="/js/vendor/jquery.js"><\/script>')</script>

    <script src="/js/plugins.1481882071.js"></script><script src="/js/main.1485346364.js"></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script type="text/javascript">
        docsearch({
            appId: 'MXXRMLZ3LA',
            apiKey: 'e21c7d87ab7d541af3087e40620862da',
            indexName: 'noesisengine',
            inputSelector: '#docsearch-input',
            debug: false // Set debug to true if you want to inspect the dropdown
        });
    </script>

    <!-- NOESIS WEB ------- END ------- -->


</div>
</body>
</html>
